create file format if not exists xml_file_format type = 'XML'  IGNORE_UTF8_ERRORS = TRUE;
create stage if not exists data_integrity_checks_xml_stage file_format = xml_file_format;


create table if not exists data_integrity_checks 
(
created_at datetime, 
reporting_date date,
table_name varchar(50),
source varchar(25), 
row_identifier varchar,
metric_name varchar,
current_value varchar,
correct_value varchar,
description varchar
);



CREATE TABLE ORDERS_RAW_DATA(
	LOADED_AT TIMESTAMP_TZ,
	ORDERNUMBER	NUMBER,
	ORDERDATE	TIMESTAMP_TZ,
	SHIPDATE	TIMESTAMP_TZ,
	FIRSTNAME	VARCHAR default '',
	LASTNAME	VARCHAR,
	COMPANY	VARCHAR,
	ADDRESS1	VARCHAR,
	ADDRESS2	VARCHAR,
	CITY	VARCHAR,
	STATE	VARCHAR,
	ZIP	VARCHAR,
	COUNTRY	VARCHAR,
	PHONE	VARCHAR,
	FAX	VARCHAR,
	EMAIL	VARCHAR,
	CCTYPE	VARCHAR,
	CCNAME	VARCHAR,
	CCNUMBER	VARCHAR,
	EXPDATE	VARCHAR,
	AUTHCODE	VARCHAR,
	TOTALCHARGED	NUMBER(38,6),
	ISSERIALNUMBERGENERATIONPENDING	BOOLEAN,
	ISSERIALNUMBERGENERATIONENABLED	BOOLEAN,
	CYBERCASHID	VARCHAR,
	STATUS	VARCHAR,
	S_COMPANY	VARCHAR,
	S_ADDRESS1	VARCHAR,
	S_ADDRESS2	VARCHAR,
	S_CITY	VARCHAR,
	S_STATE	VARCHAR,
	S_ZIP	VARCHAR,
	S_COUNTRYID	NUMBER,
    S_PHONE	VARCHAR,
	SHIPPINGCHARGES	NUMBER(38,6),
	WEIGHT	NUMBER(38,6),
	CUSTOMERID	NUMBER,
	COUNTRYID	NUMBER,
	ADDRESS3	VARCHAR,
	S_ADDRESS3	VARCHAR,
	--NOTES	VARCHAR,
	ORDERTYPEID	NUMBER,
	SALESTAXRATE	NUMBER(38,6),
	SALESTAXAMOUNT	NUMBER(38,4),
	BALANCE	NUMBER(38,6),
	PO_NUMBER	VARCHAR,
	SHIPPINGTYPEID	NUMBER,
	ISRESIDENTIAL	BOOLEAN,
	SHIPPINGNOTES	VARCHAR,
	S_ATTN	VARCHAR,
	ATTN	VARCHAR,
	SHIPPINGBATCHID	NUMBER,
	S_COMPANYID	NUMBER,
	COMPANYID	NUMBER,
	INVOICENUMBER	VARCHAR,
	CREATEDBY	VARCHAR,
	ORDEREDBY	VARCHAR,
	ISADVANCEDNETWORKORDER	BOOLEAN, 
	RETURNTYPEID	NUMBER,
	STATEMENTID	NUMBER,
	S_COUNTY	VARCHAR,
	ORIG_ORDERNUMBER	NUMBER,
	DOWNLOADNOTIFICATIONEMAIL	VARCHAR,
	ISPRINTINVOICEENABLED	BOOLEAN,
	SHIPPINGPRIORITY	NUMBER,
	ISSINGLECOPY	BOOLEAN,
	PLATFORMTYPES	VARCHAR,
	ISFREEUPGRADEORDER	BOOLEAN,
	B_EMAIL	VARCHAR,
	S_PO_NUMBER	VARCHAR,
	ISINVOICEPRINTED	BOOLEAN,
	RENEWEDSUBSCRIPTIONID	NUMBER,
	SUBSCRIPTIONID	NUMBER,
	EXTERNALINVOICENUMBER	VARCHAR,
	ORDERCATEGORYID NUMBER,
	DATECREATED TIMESTAMP_TZ,
	DATEMODIFIED TIMESTAMP_TZ
 ) 